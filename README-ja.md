# PDF to Markdown

このアプリケーションは、PDF ファイルをアップロードし、Mistral AI の OCR 機能を使って内容を解析するためのツールです。

## Mistral AI API キーの取得

1. [Mistral AI](https://mistral.ai/)にアクセスしてアカウントを作成またはログインします
2. ダッシュボードから API キーを生成します
3. 生成された API キーを安全に保管してください

## Vercel Blob の設定

アプリケーションをデプロイする前に、Vercel Blob ストレージを設定する必要があります：

1. **Vercel プロジェクトを作成する**

   - [Vercel](https://vercel.com/) にアクセスしてサインアップ／ログイン
   - 「New Project」をクリックして新しいプロジェクトを作成

2. **Vercel Blob ストアを作成する**

   - プロジェクトダッシュボードの「Storage」タブを選択
   - 「Connect Database」ボタンをクリック
   - 「Create New」タブで「Blob」を選択し、「Continue」ボタンをクリック
   - 以下の設定を行います：
     - 名前：任意の名前（例：「PDF Storage」）
     - 「Create a new Blob store」を選択
     - 環境変数を追加したい環境を選択（通常は全ての環境）
     - 必要に応じて「Advanced Options」で環境変数のプレフィックスを変更可能
   - 「Create」ボタンをクリックしてストアを作成

3. **環境変数の設定**

   - Blob ストアが作成されると、自動的に以下の環境変数がプロジェクトに追加されます：
     - `BLOB_READ_WRITE_TOKEN`
   - ローカル開発環境でこの環境変数を使用するには、Vercel CLI を使って環境変数をプルします：
     ```bash
     vercel env pull
     ```

これらの設定が完了したら、アプリケーションのデプロイに進むことができます。

## Vercel へのデプロイ手順

このアプリケーションを Vercel にデプロイするには、以下の手順に従ってください：

1. **リポジトリをクローンする**

   ```bash
   git clone <リポジトリURL>
   cd pdf-to-markdown
   ```

2. **.env.example ファイルをコピーする**

   ```bash
   cp .env.example .env
   ```

3. **.env ファイルに必要な環境変数を設定する**

   - Vercel ダッシュボードから`BLOB_READ_WRITE_TOKEN`を取得し設定
   - Mistral AI のアカウントから`MISTRAL_API_KEY`を取得し設定

   ```
   MISTRAL_API_KEY=your_mistral_api_key
   BLOB_READ_WRITE_TOKEN=your_blob_read_write_token
   ```

4. **Vercel にデプロイする**

   - [Vercel](https://vercel.com)にログインまたはアカウント作成
   - 「New Project」をクリック
   - GitHub からリポジトリをインポート
   - 「Environment Variables」セクションで、`.env`ファイルと同じ環境変数を追加
   - 「Deploy」ボタンをクリック

5. **デプロイの確認**
   - デプロイが完了したら、表示される URL にアクセスしてアプリケーションが正常に動作していることを確認

注意: 環境変数は機密情報を含むため、`.env`ファイルは GitHub などの公開リポジトリにコミットしないでください。代わりに、Vercel のダッシュボード上で直接環境変数を設定してください。

## 機能

- PDF ファイルのアップロード
- Vercel Blob ストレージへの PDF の保存
- Mistral AI の OCR 機能を使用した PDF の解析
- 解析結果の表示と編集
- マークダウン形式でのエクスポート機能

## 環境設定

以下の環境変数を`.env.local`ファイルに設定してください：

```
# Vercel Blob設定
BLOB_READ_WRITE_TOKEN=your_blob_read_write_token

# Mistral AI設定
MISTRAL_API_KEY=your_mistral_api_key
```

## アプリケーションの使い方

### 初期設定

1. アプリケーションにアクセスし、必要に応じてユーザー登録・ログインを行います
2. トップページから「新しいプロジェクト」を作成します

### PDF のアップロードと解析

1. 「PDF をアップロード」ボタンをクリックして、ファイル選択ダイアログを開きます
2. 解析したい PDF ファイルを選択します（複数ファイルも可能）
   - 注意: サーバーアップロードの場合、ファイルサイズは 4.5MB 以下である必要があります
   - 4.5MB より大きいファイルの場合は、クライアントアップロード機能を使用します
3. 「アップロード」ボタンをクリックして PDF を Vercel Blob ストレージにアップロードします
4. アップロード完了後、「Mistral AI で解析」ボタンをクリックします
5. 解析が完了するまで数秒〜数分待ちます（PDF のサイズと複雑さによって異なります）

### 解析結果の確認と編集

1. 解析結果は自動的にマークダウン形式で表示されます
2. テキストエディターで内容を自由に編集できます
3. 「保存」ボタンをクリックして編集内容を保存します
4. 「プレビュー」タブで、マークダウンがどのように表示されるかを確認できます

### マークダウンのエクスポート

1. 「エクスポート」ボタンをクリックして、エクスポート形式を選択します
   - マークダウンファイル (.md)
   - HTML (.html)
   - PDF (.pdf)
2. 選択した形式でファイルがダウンロードされます

### プロジェクト管理

1. 「プロジェクト」タブから過去の解析結果にアクセスできます
2. 各プロジェクトは自動保存され、いつでも編集を再開できます
3. 「共有」ボタンで、他のユーザーとプロジェクトを共有できます

## 必要な環境

- Node.js 18 以上
- Vercel アカウント（Blob ストア設定済み）
- Mistral AI のアカウントと API キー

## インストール方法

```bash
# 依存関係のインストール
npm install

# Vercel Blob SDKのインストール
npm install @vercel/blob

# 開発サーバーの起動
npm run dev
```

## 技術スタック

- Next.js
- TypeScript
- Vercel Blob（ストレージ）
- Mistral AI（OCR 処理）
- TailwindCSS（スタイリング）
- React Markdown（マークダウンレンダリング）

## トラブルシューティング

- **PDF のアップロードができない場合**

  - ファイルサイズが 4.5MB 以下であることを確認してください（サーバーアップロードの場合）
  - 4.5MB より大きいファイルの場合は、クライアントアップロード機能を使用してください
  - ブラウザのキャッシュをクリアしてみてください

- **解析が失敗する場合**

  - PDF が暗号化されていないか確認してください
  - スキャンされた PDF の場合、画像品質が十分かチェックしてください

- **API エラーが表示される場合**
  - 環境変数が正しく設定されているか確認してください
  - Mistral API キーの有効期限や利用制限を確認してください
  - Vercel Blob トークンが有効であることを確認してください

## ライセンス

このプロジェクトは MIT ライセンスの下で公開されています。詳細は[LICENSE](./LICENSE)ファイルをご覧ください。
